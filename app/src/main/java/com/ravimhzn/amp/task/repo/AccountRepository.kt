package com.ravimhzn.amp.task.repo

import com.ravimhzn.amp.network.ApiService
import com.ravimhzn.amp.task.model.Account
import com.ravimhzn.amp.task.model.AccountsResponse
import com.ravimhzn.amp.task.model.TransactionResponse
import retrofit2.Response
import javax.inject.Inject

class AccountRepository @Inject constructor(private val apiService: ApiService) :
    AccountDataSource {

    /**
     * Ideally Token Should be coming from token api during login
     * Please check tokenExpiry if api doesn't work. Token expires in #### minutes at 17:07 28/03/25
     */
    private val accessToken =
        "eyJhbGciOiJQUzI1NiIsInppcCI6IkdaSVAifQ.H4sIAAAAAAAA_21Ty46jMBD8lRHn6ZFxTCDc5rY_sB_Q2O3EGrCRbTI7Wu2_r4khhCg3qqof1e7mb2FCKNoCRwOKBvcRIvre2HOH9utDuqF4L8LUpQjRcK0lNsCIOhBdJaFhvAHd8ZMuG3EoGaVg-jMWbVmLQ1WzI-fvhcGYCdEIPhMopZts_OV6Rf63UUttxZgCzsojCMkRulNZQUmHitesalRdp9rRfZHNGUdRHgXvGpBNjSBYCj6piqArBZNcd8iZTBlprE8pKYStDyWjUIuKpT4HlRIqTKmyPCBjR43NPLB0I82Pkp3C5WYVLA7UekL19iTEn_FJMIpsNNqQ3_O9CXHHLEApn0y2pEy8g6zEiPIy0D1yw9_eRHrDKV6cNyGtDIxV5mrUhH0O7rBHKxdrEr0C6Wz0rs-NZmbRnNXGDxiNs-A06MmqxYCcQnTDOgcNaJbsAa3CSK2inpKPFd7CBoqYELYywVlc8S1zxB-iVcpgKZLBFgRmwPNSM2vbJ0SPNqCcPd9p6J1M02-1MwFufoZndsnyTpt-bZV776hblCdJZow7EPZS3kfAa1pFgLPbfOy4ZdQdd6vzyOThdHr2FyU28UWtTcxF5YXU1JOCNPZ2RoFiTANO4wJHXM8k_f_pitIxOa8e2u_Zte-efZEP7tve-UizAZDh-kyNSmfqcae3VTwvufj3H6GI4dmyBAAA.JxStSYl-A4zAKwhlCT9aCLFhum31JvFcxL155ATNGOTBRP18XD87Cl_yACcE8330LmF7zAQaSOtw6z7SPA6JRP8dF0WktmT-ZfOIYkmN2YNc7wHY-RFciuOGveILPx6S10ShiNLdfF_uB8FkF6vkDoarnAFIVf-rR5uLFjVffVGjg1Sz8yo2A8AedaVnbWOzbDGPnV4X5tcyX1q7TAn5I261HiCLkHUWuLx0wjgdgtBBCvTgvrDSEyrWI5UvLThzrsXqSFQpWP_Dyuxo9NDQ5ynFRhD5qLKglfEFgNRGB6D99IwbSZPWBVZgXW_erEiyoqrEBJGnVS6ze-pdh08jdjmgcakWOQ6SwK0S8oGAVX0bcrt8qGA2YwOpe2byI0_Yg-JpqOMpDeU408W5QAYwd7lY5pKPsTQoZGBpuulyunc1jKP1GUe0nqZgXSd_Tetbf7z93Eui08M8wO1VAdUPfmyptLLT_7jhOEMRCQ1z3FKEXoZLO0gc28psVr5p9J9F9Rofgp9UN1rUzK4DeqO1RqVCi2lXLIb_ifmOoH-XaeUHhHYOJUC023kK-Rzrx1MRNaXcXlNi-FiwPet12QB8Ps_igkb93zGMU8YDPK3gMmuyk9A_P-lMPwYWl3_Jg2MFKBiUNhzgnfHhJEdglBxyzdKoOeESPjA8kcwGFFXmAUA"
    //Expired Token (for testing) - "eyJhbGciOiJQUzI1NiIsInppcCI6IkdaSVAifQ.H4sIAAAAAAAA_21Ty5KjMAz8lSnOoynzCiS3ue0P7AcIS05cAzZlm8xObe2_r4khhFRudLceLUv8zbT32SnDUQPxYD98QNdrc-7QfH1IO2TvmZ-6GFG1hVISWxDMHVRdLaEVRQuqK44qb6syFxyD-c-YnfImwqoQzeE90xgSIer6MBMopZ1M-GV7Yvdb01KbhCAoRH6AShYI3TGvIeeyLhpRt9Q0sXawX2y2jPpQdnBs2goqKpv4JY5QCs6VPHDR5m3MiGN9Ssneb1kcjUJT1SL2KQm6vEY4ksxLFOKgcM7y0o48P0pyCpebVTA48Mkx0tuTEH7GJ0ETm6CVZrfne-3DjlkAkYsmT0w63EFSQkB5GfgeueFvpwO_4RQu1mkfVwbakL5qmrBPwR32aORiTaIjkNYEZ_vUaGYWzRql3YBBWwNWgZoMLQbk5IMd1jl4QL1kD2gIA5-Ie44-VngLGzhgRHiSEc7iim-ZI_4wr1ICS5EEtiDQA56XmknbPiE4NB7l7PlOQ29lnH6rnQiw8zM8s0uWs0r3a6vUe0fdohxL1mPYAb-X0j48XuMqPJzt5mPHLaPuuFudRyYNp-KzvyixiS9qbWIqKi9MU88EceztjDyHEAecxgWOuJ5J_P_jFcVjso4e2u_Zte-efZEP9tvc-cCzAZD--kyNpBL1uNPbKp6XnP37D8biS5CyBAAA.YeG9jK6MRk14VadujYuhUd2tyZLKDlYMm0a7CtKznpWMGBUnDYx2r24N2hKWc5c_1uFfut3E0YY2Fc86fujV-6B_376WhCA8fjMSNJR9T0i2nLetM91ZlhoYDJkePyt8O35HPUpmXV7OAXKYqv3m5Is0ZnplTTLc5KmY23ZgyK-Cdq8MoY_PsxBlNxUoeqWwr1vRmlylGN__8xtL_uBpBJm7lwKICkSMRRJtz5PJWgK83S1tVigi7C07H88j9na7L6X0NllM_Bt1vdWAvgs-RU-8gcHYHjUTOnZZHuruCdomUfqb1lffpxAz8yjct_ymYkecTcTNuGoYUBh9PUU4iURhMahzagXRe5S3McDfGnZckBrIb3bv45Rmy_NaIxpH_f1SIIJMcgkRejhOqLRoULhutOur_HkAQVtnJZlFBjPh3rXALafKFTXAXvtkKpUWslAUCk6KZnWIvJ9XPHJ1RjIDsw_c5AxRqSk3H7bCpsAUQDHC4H9djqavjW-CzFgt3QM3OBsG0QL0aaBn6nlYfuS-bXC34fcg7Ym6DbqOb7n14I5UEFlDTQtc3pTix1i1FVvIhhUpxlnMXeHLm23qzaQ0EUSnJL31S5OlCr343HVu8qzT_DcxEDrqvpZ-B7lPerP-CBJFKndnk6jwRyCDSkMsvh4wPVrBVSgp70WupFk"

    private fun constructedHeaders() = hashMapOf("Authorization" to "Bearer $accessToken")

    override suspend fun getAccountDetails(): Response<AccountsResponse> {
        return apiService.getAccountDetail(constructedHeaders())
    }

    override suspend fun getTransactions(account: Account): Response<TransactionResponse> {
        return apiService.getTransactionList(
            constructedHeaders(),
            account.accountUid,
            account.defaultCategory,
            account.createdAt
        )
    }
}